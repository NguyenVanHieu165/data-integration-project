{"time": "2025-12-07 12:10:39", "level": "INFO", "message": "================================================================================"}
{"time": "2025-12-07 12:10:39", "level": "INFO", "message": "MAIN ETL PIPELINE - Producer ‚Üí RabbitMQ ‚Üí Consumer ‚Üí Validate + Transform ‚Üí Load"}
{"time": "2025-12-07 12:10:39", "level": "INFO", "message": "Run ID: 20251207_121039"}
{"time": "2025-12-07 12:10:39", "level": "INFO", "message": "Database: DB_20251207_121039"}
{"time": "2025-12-07 12:10:39", "level": "INFO", "message": "================================================================================"}
{"time": "2025-12-07 12:10:39", "level": "INFO", "message": "\nüîπ PHASE 0: T·∫†O DATABASE M·ªöI"}
{"time": "2025-12-07 12:10:39", "level": "INFO", "message": "--------------------------------------------------------------------------------"}
{"time": "2025-12-07 12:10:39", "level": "INFO", "message": "K·∫øt n·ªëi SQL Server th√†nh c√¥ng: localhost,1433/master"}
{"time": "2025-12-07 12:10:39", "level": "INFO", "message": "üì¶ T·∫°o database: DB_20251207_121039"}
{"time": "2025-12-07 12:10:40", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 0 rows"}
{"time": "2025-12-07 12:10:40", "level": "INFO", "message": "   ‚úÖ ƒê√£ t·∫°o database: DB_20251207_121039"}
{"time": "2025-12-07 12:10:40", "level": "INFO", "message": "‚úÖ Database ƒë√£ s·∫µn s√†ng"}
{"time": "2025-12-07 12:10:40", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi SQL Server"}
{"time": "2025-12-07 12:10:40", "level": "INFO", "message": "K·∫øt n·ªëi SQL Server th√†nh c√¥ng: localhost,1433/DB_20251207_121039"}
{"time": "2025-12-07 12:10:40", "level": "INFO", "message": "Query th√†nh c√¥ng, -1 rows affected"}
{"time": "2025-12-07 12:10:40", "level": "INFO", "message": "   ‚úÖ ƒê√£ t·∫°o schema: staging"}
{"time": "2025-12-07 12:10:40", "level": "INFO", "message": "Query th√†nh c√¥ng, -1 rows affected"}
{"time": "2025-12-07 12:10:40", "level": "INFO", "message": "   ‚úÖ ƒê√£ t·∫°o staging tables (CSV + SQL)"}
{"time": "2025-12-07 12:10:40", "level": "INFO", "message": "‚úÖ Setup database ho√†n th√†nh"}
{"time": "2025-12-07 12:10:40", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi SQL Server"}
{"time": "2025-12-07 12:10:40", "level": "INFO", "message": "\nüîπ PHASE 1: PRODUCER ‚Üí RabbitMQ"}
{"time": "2025-12-07 12:10:40", "level": "INFO", "message": "--------------------------------------------------------------------------------"}
{"time": "2025-12-07 12:10:40", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 12:10:40", "level": "INFO", "message": "üìÑ Producer 1: ƒê·ªçc CSV files..."}
{"time": "2025-12-07 12:10:40", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_khach_hang"}
{"time": "2025-12-07 12:10:40", "level": "INFO", "message": "   ‚úì khachhang.csv: 501 messages ‚Üí queue_khach_hang"}
{"time": "2025-12-07 12:10:40", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_loai_mon"}
{"time": "2025-12-07 12:10:40", "level": "INFO", "message": "   ‚úì loaisanpham.csv: 7 messages ‚Üí queue_loai_mon"}
{"time": "2025-12-07 12:10:40", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_mon"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "   ‚úì tensanpham.csv: 500 messages ‚Üí queue_mon"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_nguyen_lieu"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "   ‚úì nguyenlieu.csv: 501 messages ‚Üí queue_nguyen_lieu"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_dat_hang"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "   ‚úì dathang.csv: 30 messages ‚Üí queue_dat_hang"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "\nüíæ Producer 2: ƒê·ªçc SQL Server..."}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "T·∫°o k·∫øt n·ªëi t·ªõi Source DB: ComVanPhong"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "K·∫øt n·ªëi SQL Server th√†nh c√¥ng: localhost,1433/ComVanPhong"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "L·∫•y danh s√°ch tables t·ª´ schema: dbo"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 6 rows"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "T√¨m th·∫•y 6 tables: dat_hang_tbl, khach_hang_tbl, loai_mon_tbl, mon_tbl, nguyen_lieu_tbl, sysdiagrams"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_dat_hang"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "ƒê·ªçc d·ªØ li·ªáu t·ª´ dbo.dat_hang_tbl"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 169 rows"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "   ‚úì dat_hang_tbl: 169 messages ‚Üí queue_dat_hang"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_khach_hang"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "ƒê·ªçc d·ªØ li·ªáu t·ª´ dbo.khach_hang_tbl"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 120 rows"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "   ‚úì khach_hang_tbl: 120 messages ‚Üí queue_khach_hang"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_loai_mon"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "ƒê·ªçc d·ªØ li·ªáu t·ª´ dbo.loai_mon_tbl"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 8 rows"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "   ‚úì loai_mon_tbl: 8 messages ‚Üí queue_loai_mon"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_mon"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "ƒê·ªçc d·ªØ li·ªáu t·ª´ dbo.mon_tbl"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 106 rows"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "   ‚úì mon_tbl: 106 messages ‚Üí queue_mon"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_nguyen_lieu"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "ƒê·ªçc d·ªØ li·ªáu t·ª´ dbo.nguyen_lieu_tbl"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 107 rows"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "   ‚úì nguyen_lieu_tbl: 107 messages ‚Üí queue_nguyen_lieu"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi SQL Server"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "\n‚úÖ Producer phase ho√†n th√†nh!"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "   T·ªïng: 2049 messages ƒë√£ g·ª≠i v√†o RabbitMQ"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 12:10:41", "level": "INFO", "message": "\n‚è≥ ƒê·ª£i 2 gi√¢y ƒë·ªÉ message ƒë∆∞·ª£c g·ª≠i xong..."}
{"time": "2025-12-07 12:10:43", "level": "INFO", "message": "\nüîπ PHASE 2: CONSUMER ‚Üí Validate + Transform ‚Üí Load Staging"}
{"time": "2025-12-07 12:10:43", "level": "INFO", "message": "--------------------------------------------------------------------------------"}
{"time": "2025-12-07 12:10:43", "level": "INFO", "message": "üíæ K·∫øt n·ªëi Target DB: DB_20251207_121039"}
{"time": "2025-12-07 12:10:43", "level": "INFO", "message": "K·∫øt n·ªëi SQL Server th√†nh c√¥ng: localhost,1433/DB_20251207_121039"}
{"time": "2025-12-07 12:10:43", "level": "INFO", "message": "\nüì• Processing: queue_khach_hang"}
{"time": "2025-12-07 12:10:43", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 12:10:43", "level": "INFO", "message": "   Messages: 621"}
{"time": "2025-12-07 12:10:44", "level": "INFO", "message": "   Consumed: 621 | Valid: 602 (CSV: 495, SQL: 107) | Invalid: 19"}
{"time": "2025-12-07 12:10:44", "level": "INFO", "message": "   üîÑ Transform & Load [CSV]..."}
{"time": "2025-12-07 12:10:45", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 495 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 12:10:45", "level": "INFO", "message": "   ‚úÖ Loaded: 495 rows ‚Üí staging.khach_hang_csv"}
{"time": "2025-12-07 12:10:45", "level": "INFO", "message": "   üîÑ Transform & Load [SQL]..."}
{"time": "2025-12-07 12:10:45", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 107 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 12:10:45", "level": "INFO", "message": "   ‚úÖ Loaded: 107 rows ‚Üí staging.khach_hang_sql"}
{"time": "2025-12-07 12:10:45", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 12:10:45", "level": "INFO", "message": "\nüì• Processing: queue_loai_mon"}
{"time": "2025-12-07 12:10:45", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 12:10:45", "level": "INFO", "message": "   Messages: 15"}
{"time": "2025-12-07 12:10:45", "level": "INFO", "message": "   Consumed: 15 | Valid: 7 (CSV: 6, SQL: 1) | Invalid: 8"}
{"time": "2025-12-07 12:10:45", "level": "INFO", "message": "   üîÑ Transform & Load [CSV]..."}
{"time": "2025-12-07 12:10:45", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 6 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 12:10:45", "level": "INFO", "message": "   ‚úÖ Loaded: 6 rows ‚Üí staging.loai_mon_csv"}
{"time": "2025-12-07 12:10:45", "level": "INFO", "message": "   üîÑ Transform & Load [SQL]..."}
{"time": "2025-12-07 12:10:45", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 1 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 12:10:45", "level": "INFO", "message": "   ‚úÖ Loaded: 1 rows ‚Üí staging.loai_mon_sql"}
{"time": "2025-12-07 12:10:45", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 12:10:45", "level": "INFO", "message": "\nüì• Processing: queue_mon"}
{"time": "2025-12-07 12:10:45", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 12:10:45", "level": "INFO", "message": "   Messages: 606"}
{"time": "2025-12-07 12:10:46", "level": "INFO", "message": "   Consumed: 606 | Valid: 101 (CSV: 0, SQL: 101) | Invalid: 505"}
{"time": "2025-12-07 12:10:46", "level": "INFO", "message": "   üîÑ Transform & Load [SQL]..."}
{"time": "2025-12-07 12:10:46", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 101 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 12:10:46", "level": "INFO", "message": "   ‚úÖ Loaded: 101 rows ‚Üí staging.mon_sql"}
{"time": "2025-12-07 12:10:46", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 12:10:46", "level": "INFO", "message": "\nüì• Processing: queue_nguyen_lieu"}
{"time": "2025-12-07 12:10:46", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 12:10:46", "level": "INFO", "message": "   Messages: 608"}
{"time": "2025-12-07 12:10:47", "level": "INFO", "message": "   Consumed: 608 | Valid: 500 (CSV: 498, SQL: 2) | Invalid: 108"}
{"time": "2025-12-07 12:10:47", "level": "INFO", "message": "   üîÑ Transform & Load [CSV]..."}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 498 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚úÖ Loaded: 498 rows ‚Üí staging.nguyen_lieu_csv"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   üîÑ Transform & Load [SQL]..."}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 2 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚úÖ Loaded: 2 rows ‚Üí staging.nguyen_lieu_sql"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "\nüì• Processing: queue_dat_hang"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   Messages: 199"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   Consumed: 199 | Valid: 157 (CSV: 0, SQL: 157) | Invalid: 42"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   üîÑ Transform & Load [SQL]..."}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 157 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚úÖ Loaded: 157 rows ‚Üí staging.dat_hang_sql"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "\n‚úÖ Consumer phase ho√†n th√†nh!"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "\nüîπ PHASE 3: L∆ØU FAILED DATA"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "--------------------------------------------------------------------------------"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚úÖ ƒê√£ l∆∞u 682 failed records v√†o: logs\\failed_data_20251207_121039.csv"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "\n================================================================================"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "üìä T·ªîNG K·∫æT PIPELINE"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "================================================================================"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "\n1Ô∏è‚É£  PRODUCER ‚Üí RabbitMQ:"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ csv_queue_khach_hang: 501 messages"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ csv_queue_loai_mon: 7 messages"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ csv_queue_mon: 500 messages"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ csv_queue_nguyen_lieu: 501 messages"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ csv_queue_dat_hang: 30 messages"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ sql_queue_dat_hang: 169 messages"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ sql_queue_khach_hang: 120 messages"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ sql_queue_loai_mon: 8 messages"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ sql_queue_mon: 106 messages"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ sql_queue_nguyen_lieu: 107 messages"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   T·ªîNG PRODUCED: 2049 messages"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "\n2Ô∏è‚É£  CONSUMER (RabbitMQ ‚Üí Consumer):"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ khach_hang: 621 messages"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ loai_mon: 15 messages"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ mon: 606 messages"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ nguyen_lieu: 608 messages"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ dat_hang: 199 messages"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   T·ªîNG CONSUMED: 2049 messages"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "\n3Ô∏è‚É£  VALIDATE (Data Quality Rules):"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ khach_hang: Valid=602 | Invalid=19"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ loai_mon: Valid=7 | Invalid=8"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ mon: Valid=101 | Invalid=505"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ nguyen_lieu: Valid=500 | Invalid=108"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ dat_hang: Valid=157 | Invalid=42"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   T·ªîNG: Valid=1367 (66.7%) | Invalid=682 (33.3%)"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "\n4Ô∏è‚É£  TRANSFORM: Chu·∫©n h√≥a 1367 valid records"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "\n5Ô∏è‚É£  LOAD (Staging Tables):"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ staging.khach_hang_csv: 495 rows"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ staging.khach_hang_sql: 107 rows"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ staging.loai_mon_csv: 6 rows"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ staging.loai_mon_sql: 1 rows"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ staging.mon_sql: 101 rows"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ staging.nguyen_lieu_csv: 498 rows"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ staging.nguyen_lieu_sql: 2 rows"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ staging.dat_hang_sql: 157 rows"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   T·ªîNG LOADED: 1367 rows (CSV: 999, SQL: 368)"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "\n6Ô∏è‚É£  VALIDATION LOGS THEO T·ª™NG B·∫¢NG:"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ dat_hang: dat_hang_validation_20251207_121039.log (42 errors)"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ khach_hang: khach_hang_validation_20251207_121039.log (19 errors)"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ loai_mon: loai_mon_validation_20251207_121039.log (8 errors)"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ mon: mon_validation_20251207_121039.log (505 errors)"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ nguyen_lieu: nguyen_lieu_validation_20251207_121039.log (108 errors)"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "\n================================================================================"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "‚úÖ PIPELINE HO√ÄN TH√ÄNH!"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   Producer ‚Üí RabbitMQ ‚Üí Consumer ‚Üí Validate + Transform ‚Üí Load Staging"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "================================================================================"}
{"time": "2025-12-07 12:10:48", "level": "INFO"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "üìÅ Logs:"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ Pipeline: logs/pipeline.log"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ Data: logs/data.log"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ Error: logs/error.log"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ Failed data: logs/failed_data_20251207_121039.csv"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ Validation per-entity: *_validation_20251207_121039.log"}
{"time": "2025-12-07 12:10:48", "level": "INFO"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "üíæ Database: DB_20251207_121039"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ Staging CSV: staging.*_csv"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "   ‚Ä¢ Staging SQL: staging.*_sql"}
{"time": "2025-12-07 12:10:48", "level": "INFO"}
{"time": "2025-12-07 12:10:48", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi SQL Server"}
{"time": "2025-12-07 12:17:45", "level": "INFO", "message": "================================================================================"}
{"time": "2025-12-07 12:17:45", "level": "INFO", "message": "MAIN ETL PIPELINE - Producer ‚Üí RabbitMQ ‚Üí Consumer ‚Üí Validate + Transform ‚Üí Load"}
{"time": "2025-12-07 12:17:45", "level": "INFO", "message": "Run ID: 20251207_121745"}
{"time": "2025-12-07 12:17:45", "level": "INFO", "message": "Database: DB_20251207_121745"}
{"time": "2025-12-07 12:17:45", "level": "INFO", "message": "================================================================================"}
{"time": "2025-12-07 12:17:45", "level": "INFO", "message": "\nüîπ PHASE 0: T·∫†O DATABASE M·ªöI"}
{"time": "2025-12-07 12:17:45", "level": "INFO", "message": "--------------------------------------------------------------------------------"}
{"time": "2025-12-07 12:17:46", "level": "INFO", "message": "K·∫øt n·ªëi SQL Server th√†nh c√¥ng: localhost,1433/master"}
{"time": "2025-12-07 12:17:46", "level": "INFO", "message": "üì¶ T·∫°o database: DB_20251207_121745"}
{"time": "2025-12-07 12:17:46", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 0 rows"}
{"time": "2025-12-07 12:17:46", "level": "INFO", "message": "   ‚úÖ ƒê√£ t·∫°o database: DB_20251207_121745"}
{"time": "2025-12-07 12:17:46", "level": "INFO", "message": "‚úÖ Database ƒë√£ s·∫µn s√†ng"}
{"time": "2025-12-07 12:17:46", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi SQL Server"}
{"time": "2025-12-07 12:17:46", "level": "INFO", "message": "K·∫øt n·ªëi SQL Server th√†nh c√¥ng: localhost,1433/DB_20251207_121745"}
{"time": "2025-12-07 12:17:46", "level": "INFO", "message": "Query th√†nh c√¥ng, -1 rows affected"}
{"time": "2025-12-07 12:17:46", "level": "INFO", "message": "   ‚úÖ ƒê√£ t·∫°o schema: staging"}
{"time": "2025-12-07 12:17:46", "level": "INFO", "message": "Query th√†nh c√¥ng, -1 rows affected"}
{"time": "2025-12-07 12:17:46", "level": "INFO", "message": "   ‚úÖ ƒê√£ t·∫°o staging tables (CSV + SQL)"}
{"time": "2025-12-07 12:17:46", "level": "INFO", "message": "‚úÖ Setup database ho√†n th√†nh"}
{"time": "2025-12-07 12:17:46", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi SQL Server"}
{"time": "2025-12-07 12:17:46", "level": "INFO", "message": "\nüîπ PHASE 1: PRODUCER ‚Üí RabbitMQ"}
{"time": "2025-12-07 12:17:46", "level": "INFO", "message": "--------------------------------------------------------------------------------"}
{"time": "2025-12-07 12:17:46", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 12:17:46", "level": "INFO", "message": "üìÑ Producer 1: ƒê·ªçc CSV files..."}
{"time": "2025-12-07 12:17:46", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_khach_hang"}
{"time": "2025-12-07 12:17:46", "level": "INFO", "message": "   ‚úì khachhang.csv: 501 messages ‚Üí queue_khach_hang"}
{"time": "2025-12-07 12:17:46", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_loai_mon"}
{"time": "2025-12-07 12:17:46", "level": "INFO", "message": "   ‚úì loaisanpham.csv: 7 messages ‚Üí queue_loai_mon"}
{"time": "2025-12-07 12:17:46", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_mon"}
{"time": "2025-12-07 12:17:46", "level": "INFO", "message": "   ‚úì tensanpham.csv: 500 messages ‚Üí queue_mon"}
{"time": "2025-12-07 12:17:46", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_nguyen_lieu"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "   ‚úì nguyenlieu.csv: 501 messages ‚Üí queue_nguyen_lieu"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_dat_hang"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "   ‚úì dathang.csv: 30 messages ‚Üí queue_dat_hang"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "\nüíæ Producer 2: ƒê·ªçc SQL Server..."}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "T·∫°o k·∫øt n·ªëi t·ªõi Source DB: ComVanPhong"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "K·∫øt n·ªëi SQL Server th√†nh c√¥ng: localhost,1433/ComVanPhong"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "L·∫•y danh s√°ch tables t·ª´ schema: dbo"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 6 rows"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "T√¨m th·∫•y 6 tables: dat_hang_tbl, khach_hang_tbl, loai_mon_tbl, mon_tbl, nguyen_lieu_tbl, sysdiagrams"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_dat_hang"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "ƒê·ªçc d·ªØ li·ªáu t·ª´ dbo.dat_hang_tbl"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 169 rows"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "   ‚úì dat_hang_tbl: 169 messages ‚Üí queue_dat_hang"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_khach_hang"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "ƒê·ªçc d·ªØ li·ªáu t·ª´ dbo.khach_hang_tbl"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 120 rows"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "   ‚úì khach_hang_tbl: 120 messages ‚Üí queue_khach_hang"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_loai_mon"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "ƒê·ªçc d·ªØ li·ªáu t·ª´ dbo.loai_mon_tbl"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 8 rows"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "   ‚úì loai_mon_tbl: 8 messages ‚Üí queue_loai_mon"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_mon"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "ƒê·ªçc d·ªØ li·ªáu t·ª´ dbo.mon_tbl"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 106 rows"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "   ‚úì mon_tbl: 106 messages ‚Üí queue_mon"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_nguyen_lieu"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "ƒê·ªçc d·ªØ li·ªáu t·ª´ dbo.nguyen_lieu_tbl"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 107 rows"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "   ‚úì nguyen_lieu_tbl: 107 messages ‚Üí queue_nguyen_lieu"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi SQL Server"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "\n‚úÖ Producer phase ho√†n th√†nh!"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "   T·ªïng: 2049 messages ƒë√£ g·ª≠i v√†o RabbitMQ"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 12:17:47", "level": "INFO", "message": "\n‚è≥ ƒê·ª£i 2 gi√¢y ƒë·ªÉ message ƒë∆∞·ª£c g·ª≠i xong..."}
{"time": "2025-12-07 12:17:49", "level": "INFO", "message": "\nüîπ PHASE 2: CONSUMER ‚Üí Validate + Transform ‚Üí Load Staging"}
{"time": "2025-12-07 12:17:49", "level": "INFO", "message": "--------------------------------------------------------------------------------"}
{"time": "2025-12-07 12:17:49", "level": "INFO", "message": "üíæ K·∫øt n·ªëi Target DB: DB_20251207_121745"}
{"time": "2025-12-07 12:17:49", "level": "INFO", "message": "K·∫øt n·ªëi SQL Server th√†nh c√¥ng: localhost,1433/DB_20251207_121745"}
{"time": "2025-12-07 12:17:49", "level": "INFO", "message": "\nüì• Processing: queue_khach_hang"}
{"time": "2025-12-07 12:17:49", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 12:17:49", "level": "INFO", "message": "   Messages: 621"}
{"time": "2025-12-07 12:17:50", "level": "INFO", "message": "   Consumed: 621 | Valid: 602 (CSV: 495, SQL: 107) | Invalid: 19"}
{"time": "2025-12-07 12:17:50", "level": "INFO", "message": "   üîÑ Transform & Load [CSV]..."}
{"time": "2025-12-07 12:17:51", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 495 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 12:17:51", "level": "INFO", "message": "   ‚úÖ Loaded: 495 rows ‚Üí staging.khach_hang_csv"}
{"time": "2025-12-07 12:17:51", "level": "INFO", "message": "   üîÑ Transform & Load [SQL]..."}
{"time": "2025-12-07 12:17:51", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 107 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 12:17:51", "level": "INFO", "message": "   ‚úÖ Loaded: 107 rows ‚Üí staging.khach_hang_sql"}
{"time": "2025-12-07 12:17:51", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 12:17:51", "level": "INFO", "message": "\nüì• Processing: queue_loai_mon"}
{"time": "2025-12-07 12:17:51", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 12:17:51", "level": "INFO", "message": "   Messages: 15"}
{"time": "2025-12-07 12:17:51", "level": "INFO", "message": "   Consumed: 15 | Valid: 7 (CSV: 6, SQL: 1) | Invalid: 8"}
{"time": "2025-12-07 12:17:51", "level": "INFO", "message": "   üîÑ Transform & Load [CSV]..."}
{"time": "2025-12-07 12:17:51", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 6 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 12:17:51", "level": "INFO", "message": "   ‚úÖ Loaded: 6 rows ‚Üí staging.loai_mon_csv"}
{"time": "2025-12-07 12:17:51", "level": "INFO", "message": "   üîÑ Transform & Load [SQL]..."}
{"time": "2025-12-07 12:17:51", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 1 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 12:17:51", "level": "INFO", "message": "   ‚úÖ Loaded: 1 rows ‚Üí staging.loai_mon_sql"}
{"time": "2025-12-07 12:17:51", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 12:17:51", "level": "INFO", "message": "\nüì• Processing: queue_mon"}
{"time": "2025-12-07 12:17:51", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 12:17:51", "level": "INFO", "message": "   Messages: 606"}
{"time": "2025-12-07 12:17:52", "level": "INFO", "message": "   Consumed: 606 | Valid: 101 (CSV: 0, SQL: 101) | Invalid: 505"}
{"time": "2025-12-07 12:17:52", "level": "INFO", "message": "   üîÑ Transform & Load [SQL]..."}
{"time": "2025-12-07 12:17:52", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 101 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 12:17:52", "level": "INFO", "message": "   ‚úÖ Loaded: 101 rows ‚Üí staging.mon_sql"}
{"time": "2025-12-07 12:17:52", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 12:17:52", "level": "INFO", "message": "\nüì• Processing: queue_nguyen_lieu"}
{"time": "2025-12-07 12:17:52", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 12:17:52", "level": "INFO", "message": "   Messages: 608"}
{"time": "2025-12-07 12:17:53", "level": "INFO", "message": "   Consumed: 608 | Valid: 600 (CSV: 498, SQL: 102) | Invalid: 8"}
{"time": "2025-12-07 12:17:53", "level": "INFO", "message": "   üîÑ Transform & Load [CSV]..."}
{"time": "2025-12-07 12:17:53", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 498 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 12:17:53", "level": "INFO", "message": "   ‚úÖ Loaded: 498 rows ‚Üí staging.nguyen_lieu_csv"}
{"time": "2025-12-07 12:17:53", "level": "INFO", "message": "   üîÑ Transform & Load [SQL]..."}
{"time": "2025-12-07 12:17:53", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 102 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 12:17:53", "level": "INFO", "message": "   ‚úÖ Loaded: 102 rows ‚Üí staging.nguyen_lieu_sql"}
{"time": "2025-12-07 12:17:53", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 12:17:53", "level": "INFO", "message": "\nüì• Processing: queue_dat_hang"}
{"time": "2025-12-07 12:17:53", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 12:17:53", "level": "INFO", "message": "   Messages: 199"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   Consumed: 199 | Valid: 157 (CSV: 0, SQL: 157) | Invalid: 42"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   üîÑ Transform & Load [SQL]..."}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 157 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚úÖ Loaded: 157 rows ‚Üí staging.dat_hang_sql"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "\n‚úÖ Consumer phase ho√†n th√†nh!"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "\nüîπ PHASE 3: L∆ØU FAILED DATA"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "--------------------------------------------------------------------------------"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚úÖ ƒê√£ l∆∞u 582 failed records v√†o: logs\\failed_data_20251207_121745.csv"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "\n================================================================================"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "üìä T·ªîNG K·∫æT PIPELINE"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "================================================================================"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "\n1Ô∏è‚É£  PRODUCER ‚Üí RabbitMQ:"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ csv_queue_khach_hang: 501 messages"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ csv_queue_loai_mon: 7 messages"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ csv_queue_mon: 500 messages"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ csv_queue_nguyen_lieu: 501 messages"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ csv_queue_dat_hang: 30 messages"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ sql_queue_dat_hang: 169 messages"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ sql_queue_khach_hang: 120 messages"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ sql_queue_loai_mon: 8 messages"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ sql_queue_mon: 106 messages"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ sql_queue_nguyen_lieu: 107 messages"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   T·ªîNG PRODUCED: 2049 messages"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "\n2Ô∏è‚É£  CONSUMER (RabbitMQ ‚Üí Consumer):"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ khach_hang: 621 messages"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ loai_mon: 15 messages"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ mon: 606 messages"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ nguyen_lieu: 608 messages"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ dat_hang: 199 messages"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   T·ªîNG CONSUMED: 2049 messages"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "\n3Ô∏è‚É£  VALIDATE (Data Quality Rules):"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ khach_hang: Valid=602 | Invalid=19"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ loai_mon: Valid=7 | Invalid=8"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ mon: Valid=101 | Invalid=505"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ nguyen_lieu: Valid=600 | Invalid=8"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ dat_hang: Valid=157 | Invalid=42"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   T·ªîNG: Valid=1467 (71.6%) | Invalid=582 (28.4%)"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "\n4Ô∏è‚É£  TRANSFORM: Chu·∫©n h√≥a 1467 valid records"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "\n5Ô∏è‚É£  LOAD (Staging Tables):"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ staging.khach_hang_csv: 495 rows"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ staging.khach_hang_sql: 107 rows"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ staging.loai_mon_csv: 6 rows"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ staging.loai_mon_sql: 1 rows"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ staging.mon_sql: 101 rows"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ staging.nguyen_lieu_csv: 498 rows"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ staging.nguyen_lieu_sql: 102 rows"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ staging.dat_hang_sql: 157 rows"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   T·ªîNG LOADED: 1467 rows (CSV: 999, SQL: 468)"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "\n6Ô∏è‚É£  VALIDATION LOGS THEO T·ª™NG B·∫¢NG:"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ dat_hang: dat_hang_validation_20251207_121745.log (42 errors)"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ khach_hang: khach_hang_validation_20251207_121745.log (19 errors)"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ loai_mon: loai_mon_validation_20251207_121745.log (8 errors)"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ mon: mon_validation_20251207_121745.log (505 errors)"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ nguyen_lieu: nguyen_lieu_validation_20251207_121745.log (8 errors)"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "\n================================================================================"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "‚úÖ PIPELINE HO√ÄN TH√ÄNH!"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   Producer ‚Üí RabbitMQ ‚Üí Consumer ‚Üí Validate + Transform ‚Üí Load Staging"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "================================================================================"}
{"time": "2025-12-07 12:17:54", "level": "INFO"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "üìÅ Logs:"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ Pipeline: logs/pipeline.log"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ Data: logs/data.log"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ Error: logs/error.log"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ Failed data: logs/failed_data_20251207_121745.csv"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ Validation per-entity: *_validation_20251207_121745.log"}
{"time": "2025-12-07 12:17:54", "level": "INFO"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "üíæ Database: DB_20251207_121745"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ Staging CSV: staging.*_csv"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "   ‚Ä¢ Staging SQL: staging.*_sql"}
{"time": "2025-12-07 12:17:54", "level": "INFO"}
{"time": "2025-12-07 12:17:54", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi SQL Server"}
{"time": "2025-12-07 12:20:22", "level": "INFO", "message": "================================================================================"}
{"time": "2025-12-07 12:20:22", "level": "INFO", "message": "MAIN ETL PIPELINE - Producer ‚Üí RabbitMQ ‚Üí Consumer ‚Üí Validate + Transform ‚Üí Load"}
{"time": "2025-12-07 12:20:22", "level": "INFO", "message": "Run ID: 20251207_122022"}
{"time": "2025-12-07 12:20:22", "level": "INFO", "message": "Database: DB_20251207_122022"}
{"time": "2025-12-07 12:20:22", "level": "INFO", "message": "================================================================================"}
{"time": "2025-12-07 12:20:22", "level": "INFO", "message": "\nüîπ PHASE 0: T·∫†O DATABASE M·ªöI"}
{"time": "2025-12-07 12:20:22", "level": "INFO", "message": "--------------------------------------------------------------------------------"}
{"time": "2025-12-07 12:20:22", "level": "INFO", "message": "K·∫øt n·ªëi SQL Server th√†nh c√¥ng: localhost,1433/master"}
{"time": "2025-12-07 12:20:22", "level": "INFO", "message": "üì¶ T·∫°o database: DB_20251207_122022"}
{"time": "2025-12-07 12:20:22", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 0 rows"}
{"time": "2025-12-07 12:20:22", "level": "INFO", "message": "   ‚úÖ ƒê√£ t·∫°o database: DB_20251207_122022"}
{"time": "2025-12-07 12:20:22", "level": "INFO", "message": "‚úÖ Database ƒë√£ s·∫µn s√†ng"}
{"time": "2025-12-07 12:20:22", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi SQL Server"}
{"time": "2025-12-07 12:20:22", "level": "INFO", "message": "K·∫øt n·ªëi SQL Server th√†nh c√¥ng: localhost,1433/DB_20251207_122022"}
{"time": "2025-12-07 12:20:22", "level": "INFO", "message": "Query th√†nh c√¥ng, -1 rows affected"}
{"time": "2025-12-07 12:20:22", "level": "INFO", "message": "   ‚úÖ ƒê√£ t·∫°o schema: staging"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "Query th√†nh c√¥ng, -1 rows affected"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "   ‚úÖ ƒê√£ t·∫°o staging tables (CSV + SQL)"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "‚úÖ Setup database ho√†n th√†nh"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi SQL Server"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "\nüîπ PHASE 1: PRODUCER ‚Üí RabbitMQ"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "--------------------------------------------------------------------------------"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "üìÑ Producer 1: ƒê·ªçc CSV files..."}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_khach_hang"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "   ‚úì khachhang.csv: 501 messages ‚Üí queue_khach_hang"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_loai_mon"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "   ‚úì loaisanpham.csv: 7 messages ‚Üí queue_loai_mon"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_mon"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "   ‚úì tensanpham.csv: 500 messages ‚Üí queue_mon"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_nguyen_lieu"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "   ‚úì nguyenlieu.csv: 501 messages ‚Üí queue_nguyen_lieu"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_dat_hang"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "   ‚úì dathang.csv: 30 messages ‚Üí queue_dat_hang"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "\nüíæ Producer 2: ƒê·ªçc SQL Server..."}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "T·∫°o k·∫øt n·ªëi t·ªõi Source DB: ComVanPhong"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "K·∫øt n·ªëi SQL Server th√†nh c√¥ng: localhost,1433/ComVanPhong"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "L·∫•y danh s√°ch tables t·ª´ schema: dbo"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 6 rows"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "T√¨m th·∫•y 6 tables: dat_hang_tbl, khach_hang_tbl, loai_mon_tbl, mon_tbl, nguyen_lieu_tbl, sysdiagrams"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_dat_hang"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "ƒê·ªçc d·ªØ li·ªáu t·ª´ dbo.dat_hang_tbl"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 169 rows"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "   ‚úì dat_hang_tbl: 169 messages ‚Üí queue_dat_hang"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_khach_hang"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "ƒê·ªçc d·ªØ li·ªáu t·ª´ dbo.khach_hang_tbl"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 120 rows"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "   ‚úì khach_hang_tbl: 120 messages ‚Üí queue_khach_hang"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_loai_mon"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "ƒê·ªçc d·ªØ li·ªáu t·ª´ dbo.loai_mon_tbl"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 8 rows"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "   ‚úì loai_mon_tbl: 8 messages ‚Üí queue_loai_mon"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_mon"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "ƒê·ªçc d·ªØ li·ªáu t·ª´ dbo.mon_tbl"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 106 rows"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "   ‚úì mon_tbl: 106 messages ‚Üí queue_mon"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_nguyen_lieu"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "ƒê·ªçc d·ªØ li·ªáu t·ª´ dbo.nguyen_lieu_tbl"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 107 rows"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "   ‚úì nguyen_lieu_tbl: 107 messages ‚Üí queue_nguyen_lieu"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi SQL Server"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "\n‚úÖ Producer phase ho√†n th√†nh!"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "   T·ªïng: 2049 messages ƒë√£ g·ª≠i v√†o RabbitMQ"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 12:20:23", "level": "INFO", "message": "\n‚è≥ ƒê·ª£i 2 gi√¢y ƒë·ªÉ message ƒë∆∞·ª£c g·ª≠i xong..."}
{"time": "2025-12-07 12:20:25", "level": "INFO", "message": "\nüîπ PHASE 2: CONSUMER ‚Üí Validate + Transform ‚Üí Load Staging"}
{"time": "2025-12-07 12:20:25", "level": "INFO", "message": "--------------------------------------------------------------------------------"}
{"time": "2025-12-07 12:20:25", "level": "INFO", "message": "üíæ K·∫øt n·ªëi Target DB: DB_20251207_122022"}
{"time": "2025-12-07 12:20:25", "level": "INFO", "message": "K·∫øt n·ªëi SQL Server th√†nh c√¥ng: localhost,1433/DB_20251207_122022"}
{"time": "2025-12-07 12:20:25", "level": "INFO", "message": "\nüì• Processing: queue_khach_hang"}
{"time": "2025-12-07 12:20:25", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 12:20:25", "level": "INFO", "message": "   Messages: 621"}
{"time": "2025-12-07 12:20:26", "level": "INFO", "message": "   Consumed: 621 | Valid: 602 (CSV: 495, SQL: 107) | Invalid: 19"}
{"time": "2025-12-07 12:20:26", "level": "INFO", "message": "   üîÑ Transform & Load [CSV]..."}
{"time": "2025-12-07 12:20:27", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 495 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 12:20:27", "level": "INFO", "message": "   ‚úÖ Loaded: 495 rows ‚Üí staging.khach_hang_csv"}
{"time": "2025-12-07 12:20:27", "level": "INFO", "message": "   üîÑ Transform & Load [SQL]..."}
{"time": "2025-12-07 12:20:28", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 107 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 12:20:28", "level": "INFO", "message": "   ‚úÖ Loaded: 107 rows ‚Üí staging.khach_hang_sql"}
{"time": "2025-12-07 12:20:28", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 12:20:28", "level": "INFO", "message": "\nüì• Processing: queue_loai_mon"}
{"time": "2025-12-07 12:20:28", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 12:20:28", "level": "INFO", "message": "   Messages: 15"}
{"time": "2025-12-07 12:20:28", "level": "INFO", "message": "   Consumed: 15 | Valid: 7 (CSV: 6, SQL: 1) | Invalid: 8"}
{"time": "2025-12-07 12:20:28", "level": "INFO", "message": "   üîÑ Transform & Load [CSV]..."}
{"time": "2025-12-07 12:20:28", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 6 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 12:20:28", "level": "INFO", "message": "   ‚úÖ Loaded: 6 rows ‚Üí staging.loai_mon_csv"}
{"time": "2025-12-07 12:20:28", "level": "INFO", "message": "   üîÑ Transform & Load [SQL]..."}
{"time": "2025-12-07 12:20:28", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 1 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 12:20:28", "level": "INFO", "message": "   ‚úÖ Loaded: 1 rows ‚Üí staging.loai_mon_sql"}
{"time": "2025-12-07 12:20:28", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 12:20:28", "level": "INFO", "message": "\nüì• Processing: queue_mon"}
{"time": "2025-12-07 12:20:28", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 12:20:28", "level": "INFO", "message": "   Messages: 606"}
{"time": "2025-12-07 12:20:29", "level": "INFO", "message": "   Consumed: 606 | Valid: 101 (CSV: 0, SQL: 101) | Invalid: 505"}
{"time": "2025-12-07 12:20:29", "level": "INFO", "message": "   üîÑ Transform & Load [SQL]..."}
{"time": "2025-12-07 12:20:29", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 101 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 12:20:29", "level": "INFO", "message": "   ‚úÖ Loaded: 101 rows ‚Üí staging.mon_sql"}
{"time": "2025-12-07 12:20:29", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 12:20:29", "level": "INFO", "message": "\nüì• Processing: queue_nguyen_lieu"}
{"time": "2025-12-07 12:20:29", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 12:20:29", "level": "INFO", "message": "   Messages: 608"}
{"time": "2025-12-07 12:20:30", "level": "INFO", "message": "   Consumed: 608 | Valid: 600 (CSV: 498, SQL: 102) | Invalid: 8"}
{"time": "2025-12-07 12:20:30", "level": "INFO", "message": "   üîÑ Transform & Load [CSV]..."}
{"time": "2025-12-07 12:20:30", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 498 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 12:20:30", "level": "INFO", "message": "   ‚úÖ Loaded: 498 rows ‚Üí staging.nguyen_lieu_csv"}
{"time": "2025-12-07 12:20:30", "level": "INFO", "message": "   üîÑ Transform & Load [SQL]..."}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 102 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚úÖ Loaded: 102 rows ‚Üí staging.nguyen_lieu_sql"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "\nüì• Processing: queue_dat_hang"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   Messages: 199"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   Consumed: 199 | Valid: 157 (CSV: 0, SQL: 157) | Invalid: 42"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   üîÑ Transform & Load [SQL]..."}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 157 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚úÖ Loaded: 157 rows ‚Üí staging.dat_hang_sql"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "\n‚úÖ Consumer phase ho√†n th√†nh!"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "\nüîπ PHASE 3: L∆ØU FAILED DATA"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "--------------------------------------------------------------------------------"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚úÖ ƒê√£ l∆∞u 582 failed records v√†o: logs\\failed_data_20251207_122022.csv"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "\n================================================================================"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "üìä T·ªîNG K·∫æT PIPELINE"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "================================================================================"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "\n1Ô∏è‚É£  PRODUCER ‚Üí RabbitMQ:"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ csv_queue_khach_hang: 501 messages"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ csv_queue_loai_mon: 7 messages"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ csv_queue_mon: 500 messages"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ csv_queue_nguyen_lieu: 501 messages"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ csv_queue_dat_hang: 30 messages"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ sql_queue_dat_hang: 169 messages"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ sql_queue_khach_hang: 120 messages"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ sql_queue_loai_mon: 8 messages"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ sql_queue_mon: 106 messages"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ sql_queue_nguyen_lieu: 107 messages"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   T·ªîNG PRODUCED: 2049 messages"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "\n2Ô∏è‚É£  CONSUMER (RabbitMQ ‚Üí Consumer):"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ khach_hang: 621 messages"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ loai_mon: 15 messages"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ mon: 606 messages"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ nguyen_lieu: 608 messages"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ dat_hang: 199 messages"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   T·ªîNG CONSUMED: 2049 messages"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "\n3Ô∏è‚É£  VALIDATE (Data Quality Rules):"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ khach_hang: Valid=602 | Invalid=19"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ loai_mon: Valid=7 | Invalid=8"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ mon: Valid=101 | Invalid=505"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ nguyen_lieu: Valid=600 | Invalid=8"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ dat_hang: Valid=157 | Invalid=42"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   T·ªîNG: Valid=1467 (71.6%) | Invalid=582 (28.4%)"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "\n4Ô∏è‚É£  TRANSFORM: Chu·∫©n h√≥a 1467 valid records"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "\n5Ô∏è‚É£  LOAD (Staging Tables):"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ staging.khach_hang_csv: 495 rows"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ staging.khach_hang_sql: 107 rows"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ staging.loai_mon_csv: 6 rows"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ staging.loai_mon_sql: 1 rows"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ staging.mon_sql: 101 rows"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ staging.nguyen_lieu_csv: 498 rows"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ staging.nguyen_lieu_sql: 102 rows"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ staging.dat_hang_sql: 157 rows"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   T·ªîNG LOADED: 1467 rows (CSV: 999, SQL: 468)"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "\n6Ô∏è‚É£  VALIDATION LOGS THEO T·ª™NG B·∫¢NG:"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ dat_hang: dat_hang_validation_20251207_122022.log (42 errors)"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ khach_hang: khach_hang_validation_20251207_122022.log (19 errors)"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ loai_mon: loai_mon_validation_20251207_122022.log (8 errors)"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ mon: mon_validation_20251207_122022.log (505 errors)"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ nguyen_lieu: nguyen_lieu_validation_20251207_122022.log (8 errors)"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "\n================================================================================"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "‚úÖ PIPELINE HO√ÄN TH√ÄNH!"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   Producer ‚Üí RabbitMQ ‚Üí Consumer ‚Üí Validate + Transform ‚Üí Load Staging"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "================================================================================"}
{"time": "2025-12-07 12:20:31", "level": "INFO"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "üìÅ Logs:"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ Pipeline: logs/pipeline.log"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ Data: logs/data.log"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ Error: logs/error.log"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ Failed data: logs/failed_data_20251207_122022.csv"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ Validation per-entity: *_validation_20251207_122022.log"}
{"time": "2025-12-07 12:20:31", "level": "INFO"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "üíæ Database: DB_20251207_122022"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ Staging CSV: staging.*_csv"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "   ‚Ä¢ Staging SQL: staging.*_sql"}
{"time": "2025-12-07 12:20:31", "level": "INFO"}
{"time": "2025-12-07 12:20:31", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi SQL Server"}
{"time": "2025-12-07 13:23:56", "level": "INFO", "message": "================================================================================"}
{"time": "2025-12-07 13:23:56", "level": "INFO", "message": "MAIN ETL PIPELINE - Producer ‚Üí RabbitMQ ‚Üí Consumer ‚Üí Validate + Transform ‚Üí Load"}
{"time": "2025-12-07 13:23:56", "level": "INFO", "message": "Run ID: 20251207_132356"}
{"time": "2025-12-07 13:23:56", "level": "INFO", "message": "Database: DB_20251207_132356"}
{"time": "2025-12-07 13:23:56", "level": "INFO", "message": "================================================================================"}
{"time": "2025-12-07 13:23:56", "level": "INFO", "message": "\nüîπ PHASE 0: T·∫†O DATABASE M·ªöI"}
{"time": "2025-12-07 13:23:56", "level": "INFO", "message": "--------------------------------------------------------------------------------"}
{"time": "2025-12-07 13:23:56", "level": "INFO", "message": "K·∫øt n·ªëi SQL Server th√†nh c√¥ng: localhost,1433/master"}
{"time": "2025-12-07 13:23:56", "level": "INFO", "message": "üì¶ T·∫°o database: DB_20251207_132356"}
{"time": "2025-12-07 13:23:56", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 0 rows"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "   ‚úÖ ƒê√£ t·∫°o database: DB_20251207_132356"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "‚úÖ Database ƒë√£ s·∫µn s√†ng"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi SQL Server"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "K·∫øt n·ªëi SQL Server th√†nh c√¥ng: localhost,1433/DB_20251207_132356"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "Query th√†nh c√¥ng, -1 rows affected"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "   ‚úÖ ƒê√£ t·∫°o schema: staging"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "Query th√†nh c√¥ng, -1 rows affected"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "   ‚úÖ ƒê√£ t·∫°o staging tables (CSV + SQL)"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "‚úÖ Setup database ho√†n th√†nh"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi SQL Server"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "\nüîπ PHASE 1: PRODUCER ‚Üí RabbitMQ"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "--------------------------------------------------------------------------------"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "üìÑ Producer 1: ƒê·ªçc CSV files..."}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_khach_hang"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "   ‚úì khachhang.csv: 501 messages ‚Üí queue_khach_hang"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_loai_mon"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "   ‚úì loaisanpham.csv: 7 messages ‚Üí queue_loai_mon"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_mon"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "   ‚úì tensanpham.csv: 500 messages ‚Üí queue_mon"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_nguyen_lieu"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "   ‚úì nguyenlieu.csv: 501 messages ‚Üí queue_nguyen_lieu"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_dat_hang"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "   ‚úì dathang.csv: 30 messages ‚Üí queue_dat_hang"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "\nüíæ Producer 2: ƒê·ªçc SQL Server..."}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "T·∫°o k·∫øt n·ªëi t·ªõi Source DB: ComVanPhong"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "K·∫øt n·ªëi SQL Server th√†nh c√¥ng: localhost,1433/ComVanPhong"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "L·∫•y danh s√°ch tables t·ª´ schema: dbo"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 6 rows"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "T√¨m th·∫•y 6 tables: dat_hang_tbl, khach_hang_tbl, loai_mon_tbl, mon_tbl, nguyen_lieu_tbl, sysdiagrams"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_dat_hang"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "ƒê·ªçc d·ªØ li·ªáu t·ª´ dbo.dat_hang_tbl"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 169 rows"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "   ‚úì dat_hang_tbl: 169 messages ‚Üí queue_dat_hang"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_khach_hang"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "ƒê·ªçc d·ªØ li·ªáu t·ª´ dbo.khach_hang_tbl"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 120 rows"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "   ‚úì khach_hang_tbl: 120 messages ‚Üí queue_khach_hang"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_loai_mon"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "ƒê·ªçc d·ªØ li·ªáu t·ª´ dbo.loai_mon_tbl"}
{"time": "2025-12-07 13:23:57", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 8 rows"}
{"time": "2025-12-07 13:23:58", "level": "INFO", "message": "   ‚úì loai_mon_tbl: 8 messages ‚Üí queue_loai_mon"}
{"time": "2025-12-07 13:23:58", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_mon"}
{"time": "2025-12-07 13:23:58", "level": "INFO", "message": "ƒê·ªçc d·ªØ li·ªáu t·ª´ dbo.mon_tbl"}
{"time": "2025-12-07 13:23:58", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 106 rows"}
{"time": "2025-12-07 13:23:58", "level": "INFO", "message": "   ‚úì mon_tbl: 106 messages ‚Üí queue_mon"}
{"time": "2025-12-07 13:23:58", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_nguyen_lieu"}
{"time": "2025-12-07 13:23:58", "level": "INFO", "message": "ƒê·ªçc d·ªØ li·ªáu t·ª´ dbo.nguyen_lieu_tbl"}
{"time": "2025-12-07 13:23:58", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 107 rows"}
{"time": "2025-12-07 13:23:58", "level": "INFO", "message": "   ‚úì nguyen_lieu_tbl: 107 messages ‚Üí queue_nguyen_lieu"}
{"time": "2025-12-07 13:23:58", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi SQL Server"}
{"time": "2025-12-07 13:23:58", "level": "INFO", "message": "\n‚úÖ Producer phase ho√†n th√†nh!"}
{"time": "2025-12-07 13:23:58", "level": "INFO", "message": "   T·ªïng: 2049 messages ƒë√£ g·ª≠i v√†o RabbitMQ"}
{"time": "2025-12-07 13:23:58", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 13:23:58", "level": "INFO", "message": "\n‚è≥ ƒê·ª£i 2 gi√¢y ƒë·ªÉ message ƒë∆∞·ª£c g·ª≠i xong..."}
{"time": "2025-12-07 13:24:00", "level": "INFO", "message": "\nüîπ PHASE 2: CONSUMER ‚Üí Validate + Transform ‚Üí Load Staging"}
{"time": "2025-12-07 13:24:00", "level": "INFO", "message": "--------------------------------------------------------------------------------"}
{"time": "2025-12-07 13:24:00", "level": "INFO", "message": "üíæ K·∫øt n·ªëi Target DB: DB_20251207_132356"}
{"time": "2025-12-07 13:24:00", "level": "INFO", "message": "K·∫øt n·ªëi SQL Server th√†nh c√¥ng: localhost,1433/DB_20251207_132356"}
{"time": "2025-12-07 13:24:00", "level": "INFO", "message": "\nüì• Processing: queue_khach_hang"}
{"time": "2025-12-07 13:24:00", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 13:24:00", "level": "INFO", "message": "   Messages: 621"}
{"time": "2025-12-07 13:24:01", "level": "INFO", "message": "   Consumed: 621 | Valid: 602 (CSV: 495, SQL: 107) | Invalid: 19"}
{"time": "2025-12-07 13:24:01", "level": "INFO", "message": "   üîÑ Transform & Load [CSV]..."}
{"time": "2025-12-07 13:24:01", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 495 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 13:24:01", "level": "INFO", "message": "   ‚úÖ Loaded: 495 rows ‚Üí staging.khach_hang_csv"}
{"time": "2025-12-07 13:24:01", "level": "INFO", "message": "   üîÑ Transform & Load [SQL]..."}
{"time": "2025-12-07 13:24:02", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 107 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 13:24:02", "level": "INFO", "message": "   ‚úÖ Loaded: 107 rows ‚Üí staging.khach_hang_sql"}
{"time": "2025-12-07 13:24:02", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 13:24:02", "level": "INFO", "message": "\nüì• Processing: queue_loai_mon"}
{"time": "2025-12-07 13:24:02", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 13:24:02", "level": "INFO", "message": "   Messages: 15"}
{"time": "2025-12-07 13:24:02", "level": "INFO", "message": "   Consumed: 15 | Valid: 12 (CSV: 6, SQL: 6) | Invalid: 3"}
{"time": "2025-12-07 13:24:02", "level": "INFO", "message": "   üîÑ Transform & Load [CSV]..."}
{"time": "2025-12-07 13:24:02", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 6 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 13:24:02", "level": "INFO", "message": "   ‚úÖ Loaded: 6 rows ‚Üí staging.loai_mon_csv"}
{"time": "2025-12-07 13:24:02", "level": "INFO", "message": "   üîÑ Transform & Load [SQL]..."}
{"time": "2025-12-07 13:24:02", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 6 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 13:24:02", "level": "INFO", "message": "   ‚úÖ Loaded: 6 rows ‚Üí staging.loai_mon_sql"}
{"time": "2025-12-07 13:24:02", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 13:24:02", "level": "INFO", "message": "\nüì• Processing: queue_mon"}
{"time": "2025-12-07 13:24:02", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 13:24:02", "level": "INFO", "message": "   Messages: 606"}
{"time": "2025-12-07 13:24:03", "level": "INFO", "message": "   Consumed: 606 | Valid: 501 (CSV: 497, SQL: 4) | Invalid: 105"}
{"time": "2025-12-07 13:24:03", "level": "INFO", "message": "   üîÑ Transform & Load [CSV]..."}
{"time": "2025-12-07 13:24:03", "level": "ERROR", "message": "L·ªói insert batch v√†o staging.mon_csv: ('42S22', \"[42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid column name 'loai_name'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)\")"}
{"time": "2025-12-07 13:24:03", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 0 th√†nh c√¥ng, 497 l·ªói"}
{"time": "2025-12-07 13:24:03", "level": "INFO", "message": "   ‚úÖ Loaded: 0 rows ‚Üí staging.mon_csv"}
{"time": "2025-12-07 13:24:03", "level": "INFO", "message": "   üîÑ Transform & Load [SQL]..."}
{"time": "2025-12-07 13:24:03", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 4 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 13:24:03", "level": "INFO", "message": "   ‚úÖ Loaded: 4 rows ‚Üí staging.mon_sql"}
{"time": "2025-12-07 13:24:03", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 13:24:03", "level": "INFO", "message": "\nüì• Processing: queue_nguyen_lieu"}
{"time": "2025-12-07 13:24:03", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 13:24:03", "level": "INFO", "message": "   Messages: 608"}
{"time": "2025-12-07 13:24:04", "level": "INFO", "message": "   Consumed: 608 | Valid: 600 (CSV: 498, SQL: 102) | Invalid: 8"}
{"time": "2025-12-07 13:24:04", "level": "INFO", "message": "   üîÑ Transform & Load [CSV]..."}
{"time": "2025-12-07 13:24:04", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 498 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 13:24:04", "level": "INFO", "message": "   ‚úÖ Loaded: 498 rows ‚Üí staging.nguyen_lieu_csv"}
{"time": "2025-12-07 13:24:04", "level": "INFO", "message": "   üîÑ Transform & Load [SQL]..."}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 102 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚úÖ Loaded: 102 rows ‚Üí staging.nguyen_lieu_sql"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "\nüì• Processing: queue_dat_hang"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   Messages: 199"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   Consumed: 199 | Valid: 157 (CSV: 0, SQL: 157) | Invalid: 42"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   üîÑ Transform & Load [SQL]..."}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 157 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚úÖ Loaded: 157 rows ‚Üí staging.dat_hang_sql"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "\n‚úÖ Consumer phase ho√†n th√†nh!"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "\nüîπ PHASE 3: L∆ØU FAILED DATA"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "--------------------------------------------------------------------------------"}
{"time": "2025-12-07 13:24:05", "level": "ERROR", "message": "   ‚ùå L·ªói l∆∞u failed data: 'logs\\\\run_20251207_132356\\\\failed_data.csv' is not in the subpath of 'D:\\\\DATichHop\\\\coffee_etl_clean' OR one path is relative and the other is absolute."}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "\n================================================================================"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "üìä T·ªîNG K·∫æT PIPELINE"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "================================================================================"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "\n1Ô∏è‚É£  PRODUCER ‚Üí RabbitMQ:"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ csv_queue_khach_hang: 501 messages"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ csv_queue_loai_mon: 7 messages"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ csv_queue_mon: 500 messages"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ csv_queue_nguyen_lieu: 501 messages"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ csv_queue_dat_hang: 30 messages"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ sql_queue_dat_hang: 169 messages"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ sql_queue_khach_hang: 120 messages"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ sql_queue_loai_mon: 8 messages"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ sql_queue_mon: 106 messages"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ sql_queue_nguyen_lieu: 107 messages"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   T·ªîNG PRODUCED: 2049 messages"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "\n2Ô∏è‚É£  CONSUMER (RabbitMQ ‚Üí Consumer):"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ khach_hang: 621 messages"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ loai_mon: 15 messages"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ mon: 606 messages"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ nguyen_lieu: 608 messages"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ dat_hang: 199 messages"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   T·ªîNG CONSUMED: 2049 messages"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "\n3Ô∏è‚É£  VALIDATE (Data Quality Rules):"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ khach_hang: Valid=602 | Invalid=19"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ loai_mon: Valid=12 | Invalid=3"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ mon: Valid=501 | Invalid=105"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ nguyen_lieu: Valid=600 | Invalid=8"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ dat_hang: Valid=157 | Invalid=42"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   T·ªîNG: Valid=1872 (91.4%) | Invalid=177 (8.6%)"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "\n4Ô∏è‚É£  TRANSFORM: Chu·∫©n h√≥a 1872 valid records"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "\n5Ô∏è‚É£  LOAD (Staging Tables):"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ staging.khach_hang_csv: 495 rows"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ staging.khach_hang_sql: 107 rows"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ staging.loai_mon_csv: 6 rows"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ staging.loai_mon_sql: 6 rows"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ staging.mon_csv: 0 rows"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ staging.mon_sql: 4 rows"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ staging.nguyen_lieu_csv: 498 rows"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ staging.nguyen_lieu_sql: 102 rows"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ staging.dat_hang_sql: 157 rows"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   T·ªîNG LOADED: 1375 rows (CSV: 999, SQL: 376)"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "\n6Ô∏è‚É£  VALIDATION LOGS THEO T·ª™NG B·∫¢NG:"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ dat_hang: dat_hang_validation.log (42 errors)"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ khach_hang: khach_hang_validation.log (19 errors)"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ loai_mon: loai_mon_validation.log (3 errors)"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ mon: mon_validation.log (105 errors)"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ nguyen_lieu: nguyen_lieu_validation.log (8 errors)"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "\n================================================================================"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "‚úÖ PIPELINE HO√ÄN TH√ÄNH!"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   Producer ‚Üí RabbitMQ ‚Üí Consumer ‚Üí Validate + Transform ‚Üí Load Staging"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "================================================================================"}
{"time": "2025-12-07 13:24:05", "level": "INFO"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "üìÅ Logs:"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ Pipeline: logs/pipeline.log"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ Data: logs/data.log"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ Error: logs/error.log"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ Failed data: logs/failed_data_20251207_132356.csv"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ Validation per-entity: *_validation_20251207_132356.log"}
{"time": "2025-12-07 13:24:05", "level": "INFO"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "üíæ Database: DB_20251207_132356"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ Staging CSV: staging.*_csv"}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "   ‚Ä¢ Staging SQL: staging.*_sql"}
{"time": "2025-12-07 13:24:05", "level": "INFO"}
{"time": "2025-12-07 13:24:05", "level": "ERROR", "message": "‚ùå L·ªói pipeline: 'logs\\\\run_20251207_132356' is not in the subpath of 'D:\\\\DATichHop\\\\coffee_etl_clean' OR one path is relative and the other is absolute."}
{"time": "2025-12-07 13:24:05", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi SQL Server"}
{"time": "2025-12-07 13:24:05", "level": "ERROR", "message": "‚ùå Pipeline th·∫•t b·∫°i: 'logs\\\\run_20251207_132356' is not in the subpath of 'D:\\\\DATichHop\\\\coffee_etl_clean' OR one path is relative and the other is absolute."}
{"time": "2025-12-07 15:05:12", "level": "INFO", "message": "================================================================================"}
{"time": "2025-12-07 15:05:12", "level": "INFO", "message": "MAIN ETL PIPELINE - Producer ‚Üí RabbitMQ ‚Üí Consumer ‚Üí Validate + Transform ‚Üí Load"}
{"time": "2025-12-07 15:05:12", "level": "INFO", "message": "Run ID: 20251207_150512"}
{"time": "2025-12-07 15:05:12", "level": "INFO", "message": "Database: DB_20251207_150512"}
{"time": "2025-12-07 15:05:12", "level": "INFO", "message": "================================================================================"}
{"time": "2025-12-07 15:05:12", "level": "INFO", "message": "\nüîπ PHASE 0: T·∫†O DATABASE M·ªöI"}
{"time": "2025-12-07 15:05:12", "level": "INFO", "message": "--------------------------------------------------------------------------------"}
{"time": "2025-12-07 15:05:12", "level": "INFO", "message": "K·∫øt n·ªëi SQL Server th√†nh c√¥ng: localhost,1433/master"}
{"time": "2025-12-07 15:05:12", "level": "INFO", "message": "üì¶ T·∫°o database: DB_20251207_150512"}
{"time": "2025-12-07 15:05:12", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 0 rows"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "   ‚úÖ ƒê√£ t·∫°o database: DB_20251207_150512"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "‚úÖ Database ƒë√£ s·∫µn s√†ng"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi SQL Server"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "K·∫øt n·ªëi SQL Server th√†nh c√¥ng: localhost,1433/DB_20251207_150512"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "Query th√†nh c√¥ng, -1 rows affected"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "   ‚úÖ ƒê√£ t·∫°o schema: staging"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "Query th√†nh c√¥ng, -1 rows affected"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "   ‚úÖ ƒê√£ t·∫°o staging tables (CSV + SQL)"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "‚úÖ Setup database ho√†n th√†nh"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi SQL Server"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "\nüîπ PHASE 1: PRODUCER ‚Üí RabbitMQ"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "--------------------------------------------------------------------------------"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "üìÑ Producer 1: ƒê·ªçc CSV files..."}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_khach_hang"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "   ‚úì khachhang.csv: 501 messages ‚Üí queue_khach_hang"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_loai_mon"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "   ‚úì loaisanpham.csv: 7 messages ‚Üí queue_loai_mon"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_mon"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "   ‚úì tensanpham.csv: 500 messages ‚Üí queue_mon"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_nguyen_lieu"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "   ‚úì nguyenlieu.csv: 501 messages ‚Üí queue_nguyen_lieu"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_dat_hang"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "   ‚úì dathang.csv: 30 messages ‚Üí queue_dat_hang"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "\nüíæ Producer 2: ƒê·ªçc SQL Server..."}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "T·∫°o k·∫øt n·ªëi t·ªõi Source DB: ComVanPhong"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "K·∫øt n·ªëi SQL Server th√†nh c√¥ng: localhost,1433/ComVanPhong"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "L·∫•y danh s√°ch tables t·ª´ schema: dbo"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 6 rows"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "T√¨m th·∫•y 6 tables: dat_hang_tbl, khach_hang_tbl, loai_mon_tbl, mon_tbl, nguyen_lieu_tbl, sysdiagrams"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_dat_hang"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "ƒê·ªçc d·ªØ li·ªáu t·ª´ dbo.dat_hang_tbl"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 169 rows"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "   ‚úì dat_hang_tbl: 169 messages ‚Üí queue_dat_hang"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_khach_hang"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "ƒê·ªçc d·ªØ li·ªáu t·ª´ dbo.khach_hang_tbl"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 120 rows"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "   ‚úì khach_hang_tbl: 120 messages ‚Üí queue_khach_hang"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_loai_mon"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "ƒê·ªçc d·ªØ li·ªáu t·ª´ dbo.loai_mon_tbl"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 8 rows"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "   ‚úì loai_mon_tbl: 8 messages ‚Üí queue_loai_mon"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_mon"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "ƒê·ªçc d·ªØ li·ªáu t·ª´ dbo.mon_tbl"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 106 rows"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "   ‚úì mon_tbl: 106 messages ‚Üí queue_mon"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "ƒê√£ khai b√°o queue: queue_nguyen_lieu"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "ƒê·ªçc d·ªØ li·ªáu t·ª´ dbo.nguyen_lieu_tbl"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "Query th√†nh c√¥ng, tr·∫£ v·ªÅ 107 rows"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "   ‚úì nguyen_lieu_tbl: 107 messages ‚Üí queue_nguyen_lieu"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi SQL Server"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "\n‚úÖ Producer phase ho√†n th√†nh!"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "   T·ªïng: 2049 messages ƒë√£ g·ª≠i v√†o RabbitMQ"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 15:05:13", "level": "INFO", "message": "\n‚è≥ ƒê·ª£i 2 gi√¢y ƒë·ªÉ message ƒë∆∞·ª£c g·ª≠i xong..."}
{"time": "2025-12-07 15:05:15", "level": "INFO", "message": "\nüîπ PHASE 2: CONSUMER ‚Üí Validate + Transform ‚Üí Load Staging"}
{"time": "2025-12-07 15:05:15", "level": "INFO", "message": "--------------------------------------------------------------------------------"}
{"time": "2025-12-07 15:05:15", "level": "INFO", "message": "üíæ K·∫øt n·ªëi Target DB: DB_20251207_150512"}
{"time": "2025-12-07 15:05:15", "level": "INFO", "message": "K·∫øt n·ªëi SQL Server th√†nh c√¥ng: localhost,1433/DB_20251207_150512"}
{"time": "2025-12-07 15:05:15", "level": "INFO", "message": "\nüì• Processing: queue_khach_hang"}
{"time": "2025-12-07 15:05:15", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 15:05:15", "level": "INFO", "message": "   Messages: 621"}
{"time": "2025-12-07 15:05:16", "level": "INFO", "message": "   Consumed: 621 | Valid: 602 (CSV: 495, SQL: 107) | Invalid: 19"}
{"time": "2025-12-07 15:05:16", "level": "INFO", "message": "   üîÑ Transform & Load [CSV]..."}
{"time": "2025-12-07 15:05:17", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 495 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 15:05:17", "level": "INFO", "message": "   ‚úÖ Loaded: 495 rows ‚Üí staging.khach_hang_csv"}
{"time": "2025-12-07 15:05:17", "level": "INFO", "message": "   üîÑ Transform & Load [SQL]..."}
{"time": "2025-12-07 15:05:17", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 107 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 15:05:17", "level": "INFO", "message": "   ‚úÖ Loaded: 107 rows ‚Üí staging.khach_hang_sql"}
{"time": "2025-12-07 15:05:17", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 15:05:17", "level": "INFO", "message": "\nüì• Processing: queue_loai_mon"}
{"time": "2025-12-07 15:05:17", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 15:05:17", "level": "INFO", "message": "   Messages: 15"}
{"time": "2025-12-07 15:05:17", "level": "INFO", "message": "   Consumed: 15 | Valid: 12 (CSV: 6, SQL: 6) | Invalid: 3"}
{"time": "2025-12-07 15:05:17", "level": "INFO", "message": "   üîÑ Transform & Load [CSV]..."}
{"time": "2025-12-07 15:05:17", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 6 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 15:05:17", "level": "INFO", "message": "   ‚úÖ Loaded: 6 rows ‚Üí staging.loai_mon_csv"}
{"time": "2025-12-07 15:05:17", "level": "INFO", "message": "   üîÑ Transform & Load [SQL]..."}
{"time": "2025-12-07 15:05:17", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 6 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 15:05:17", "level": "INFO", "message": "   ‚úÖ Loaded: 6 rows ‚Üí staging.loai_mon_sql"}
{"time": "2025-12-07 15:05:17", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 15:05:17", "level": "INFO", "message": "\nüì• Processing: queue_mon"}
{"time": "2025-12-07 15:05:17", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 15:05:17", "level": "INFO", "message": "   Messages: 606"}
{"time": "2025-12-07 15:05:18", "level": "INFO", "message": "   Consumed: 606 | Valid: 501 (CSV: 497, SQL: 4) | Invalid: 105"}
{"time": "2025-12-07 15:05:18", "level": "INFO", "message": "   üîÑ Transform & Load [CSV]..."}
{"time": "2025-12-07 15:05:18", "level": "ERROR", "message": "L·ªói insert batch v√†o staging.mon_csv: ('42S22', \"[42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid column name 'loai_name'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)\")"}
{"time": "2025-12-07 15:05:18", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 0 th√†nh c√¥ng, 497 l·ªói"}
{"time": "2025-12-07 15:05:18", "level": "INFO", "message": "   ‚úÖ Loaded: 0 rows ‚Üí staging.mon_csv"}
{"time": "2025-12-07 15:05:18", "level": "INFO", "message": "   üîÑ Transform & Load [SQL]..."}
{"time": "2025-12-07 15:05:18", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 4 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 15:05:18", "level": "INFO", "message": "   ‚úÖ Loaded: 4 rows ‚Üí staging.mon_sql"}
{"time": "2025-12-07 15:05:18", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 15:05:18", "level": "INFO", "message": "\nüì• Processing: queue_nguyen_lieu"}
{"time": "2025-12-07 15:05:18", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 15:05:18", "level": "INFO", "message": "   Messages: 608"}
{"time": "2025-12-07 15:05:18", "level": "INFO", "message": "   Consumed: 608 | Valid: 600 (CSV: 498, SQL: 102) | Invalid: 8"}
{"time": "2025-12-07 15:05:18", "level": "INFO", "message": "   üîÑ Transform & Load [CSV]..."}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 498 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚úÖ Loaded: 498 rows ‚Üí staging.nguyen_lieu_csv"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   üîÑ Transform & Load [SQL]..."}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 102 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚úÖ Loaded: 102 rows ‚Üí staging.nguyen_lieu_sql"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "\nüì• Processing: queue_dat_hang"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "K·∫øt n·ªëi RabbitMQ th√†nh c√¥ng: localhost:5672"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   Messages: 199"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   Consumed: 199 | Valid: 194 (CSV: 30, SQL: 164) | Invalid: 5"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   üîÑ Transform & Load [CSV]..."}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 30 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚úÖ Loaded: 30 rows ‚Üí staging.dat_hang_csv"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   üîÑ Transform & Load [SQL]..."}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "Bulk insert ho√†n th√†nh: 164 th√†nh c√¥ng, 0 l·ªói"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚úÖ Loaded: 164 rows ‚Üí staging.dat_hang_sql"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi RabbitMQ"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "\n‚úÖ Consumer phase ho√†n th√†nh!"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "\nüîπ PHASE 3: L∆ØU FAILED DATA"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "--------------------------------------------------------------------------------"}
{"time": "2025-12-07 15:05:19", "level": "ERROR", "message": "   ‚ùå L·ªói l∆∞u failed data: 'logs\\\\run_20251207_150512\\\\failed_data.csv' is not in the subpath of 'D:\\\\DATichHop\\\\coffee_etl_clean' OR one path is relative and the other is absolute."}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "\n================================================================================"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "üìä T·ªîNG K·∫æT PIPELINE"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "================================================================================"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "\n1Ô∏è‚É£  PRODUCER ‚Üí RabbitMQ:"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ csv_queue_khach_hang: 501 messages"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ csv_queue_loai_mon: 7 messages"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ csv_queue_mon: 500 messages"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ csv_queue_nguyen_lieu: 501 messages"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ csv_queue_dat_hang: 30 messages"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ sql_queue_dat_hang: 169 messages"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ sql_queue_khach_hang: 120 messages"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ sql_queue_loai_mon: 8 messages"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ sql_queue_mon: 106 messages"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ sql_queue_nguyen_lieu: 107 messages"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   T·ªîNG PRODUCED: 2049 messages"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "\n2Ô∏è‚É£  CONSUMER (RabbitMQ ‚Üí Consumer):"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ khach_hang: 621 messages"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ loai_mon: 15 messages"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ mon: 606 messages"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ nguyen_lieu: 608 messages"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ dat_hang: 199 messages"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   T·ªîNG CONSUMED: 2049 messages"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "\n3Ô∏è‚É£  VALIDATE (Data Quality Rules):"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ khach_hang: Valid=602 | Invalid=19"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ loai_mon: Valid=12 | Invalid=3"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ mon: Valid=501 | Invalid=105"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ nguyen_lieu: Valid=600 | Invalid=8"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ dat_hang: Valid=194 | Invalid=5"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   T·ªîNG: Valid=1909 (93.2%) | Invalid=140 (6.8%)"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "\n4Ô∏è‚É£  TRANSFORM: Chu·∫©n h√≥a 1909 valid records"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "\n5Ô∏è‚É£  LOAD (Staging Tables):"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ staging.khach_hang_csv: 495 rows"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ staging.khach_hang_sql: 107 rows"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ staging.loai_mon_csv: 6 rows"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ staging.loai_mon_sql: 6 rows"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ staging.mon_csv: 0 rows"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ staging.mon_sql: 4 rows"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ staging.nguyen_lieu_csv: 498 rows"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ staging.nguyen_lieu_sql: 102 rows"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ staging.dat_hang_csv: 30 rows"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ staging.dat_hang_sql: 164 rows"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   T·ªîNG LOADED: 1412 rows (CSV: 1029, SQL: 383)"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "\n6Ô∏è‚É£  VALIDATION LOGS THEO T·ª™NG B·∫¢NG:"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ dat_hang: dat_hang_validation.log (5 errors)"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ khach_hang: khach_hang_validation.log (19 errors)"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ loai_mon: loai_mon_validation.log (3 errors)"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ mon: mon_validation.log (105 errors)"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ nguyen_lieu: nguyen_lieu_validation.log (8 errors)"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "\n================================================================================"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "‚úÖ PIPELINE HO√ÄN TH√ÄNH!"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   Producer ‚Üí RabbitMQ ‚Üí Consumer ‚Üí Validate + Transform ‚Üí Load Staging"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "================================================================================"}
{"time": "2025-12-07 15:05:19", "level": "INFO"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "üìÅ Logs:"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ Pipeline: logs/pipeline.log"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ Data: logs/data.log"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ Error: logs/error.log"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ Failed data: logs/failed_data_20251207_150512.csv"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ Validation per-entity: *_validation_20251207_150512.log"}
{"time": "2025-12-07 15:05:19", "level": "INFO"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "üíæ Database: DB_20251207_150512"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ Staging CSV: staging.*_csv"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "   ‚Ä¢ Staging SQL: staging.*_sql"}
{"time": "2025-12-07 15:05:19", "level": "INFO"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "\nüìÅ Log folder: logs\\run_20251207_150512"}
{"time": "2025-12-07 15:05:19", "level": "INFO", "message": "ƒê√£ ƒë√≥ng k·∫øt n·ªëi SQL Server"}
